---
title: 6.828 lab1
date: 2021-04-23 09:42:40
tags: os
---

参考：https://www.cnblogs.com/gatsby123/p/9746193.html

​	https://zhuanlan.zhihu.com/p/74028717

​	https://www.dingmos.com/2020/07/24/23.html



久闻6.828大名，以前就想学习，不过官网的schedule看不懂，xv6 doc/source看不懂（英语真的重要），被劝退了。现在6.828火了，博客技术文章越来越多，更适合学习了。我打算先上手lab，lab遇到问题再从点及面学习



lab1需要从git安装源码，然后用qemu运行xv6（qemu：能构造x86机器的模拟器），安装qemu时会遇到一些报错，比如make qemu时需要换成make qemu-nox(非图形界面)，ctrl + a，再按c可推出虚拟机器



#### part1

然后使用qemu和gdb来调试xv6

调试步骤1.先打开一个terminal来到lab下   make qemu-gdb

​			 2.打开另一个terminal来到lab下，make gdb  进入qemu的调试模式，会一行一行输出汇编命令

​             3.si进入下一条命令，调试

看不懂si调试的汇编命令，网上查了下，大概是bios对设备初始化，然后找到boot loader，把控制权交给boot loader



##### 补充知识

> **cs,ip寄存器**
> cs:ip寄存器存放的将要执行命令的地址，cs(段基址)+ip(段内偏移) cs左移4位+ip=真实地址
> jump命令实际上是修改了cs:ip的内容，跳向下条要执行的命令
>
> **实模式 保护模式**
>
> 实模式：早期8086寄存器是16位，cpu是20位，所以需要偏移，cs(段基址)+ip(段内偏移) cs左移4位+ip=真实地址是访问内存地址的模式
>
> 保护模式：实模式程序可以访问任何地址，不安全，保护模式应需而生，段寄存器不再存放段基址，存放段选择子（段描述符的索引，段描述符长度64位，32位存放段基址，剩下记录段信息；段描述符存在于全局描述符GDT内），本质就是段基址要通过索引查询获得，拼接偏移得到线性地址，如果有分页机制，还需要分页机构转换得到物理地址





#### part2

